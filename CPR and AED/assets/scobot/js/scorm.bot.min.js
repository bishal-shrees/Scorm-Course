function SCOBot(e){var f=SCOBotUtil,_=f.extend({version:"4.1.0",createDate:"04/07/2011 09:33AM",modifiedDate:"05/22/2015 05:17PM",prefix:"SCOBot",launch_data:{},interaction_mode:"state",launch_data_type:"querystring",initiate_timer:!0,scorm_strict:!0,scorm_edition:"4th",scorm_status_persist:"completion_status",useJSONSuspendData:!0,suspend_data:{pages:[]},base64:!1,happyEnding:!0,doNotStatusUntilFinish:!1,location:"",mode:"",scaled_passing_score:.7,completion_threshold:1,max_time_allowed:"",totalInteractions:0,totalObjectives:0,startTime:0},e),m={success_status:"unknown",completion_status:"incomplete",completion_threshold:_.completion_threshold,progress_measure:"0",scaled_passing_score:_.scaled_passing_score,score:{scaled:"0",raw:"0",min:"0",max:"0"}},s=!1,t=!1,u=!1,l=!1,r="|null|undefined|false|NaN|| |",o=scorm.get("error"),d=this;function a(e){scorm.debug(o[e],2)}function c(e){f.triggerEvent(d,"exception",{error:e})}function i(){if(scorm.debug(_.prefix+": SCO is being unloaded, forcing exit ...",3),scorm.isConnectionActive()){switch(f.triggerEvent(d,"unload"),scorm.get("exit_type")){case"finish":d.finish();break;case"suspend":d.suspend();break;case"timeout":d.timeout();break;default:scorm.debug(_.prefix+": unknown exit type",2)}scorm.debug(_.prefix+": SCO is done unloading.",4)}return!0}function v(e){return 0<=r.indexOf("|"+e+"|")}function n(e){var s;switch(scorm.get("time_type")){case"UTC":s=/^(\d{4})-0?(\d+)-0?(\d+)[T ]0?(\d+):0?(\d+):0?(\d+)(?:\.(\d+))(|Z)$/;break;case"GMT":s=/^(\d{4})-0?(\d+)-0?(\d+)[T ]0?(\d+):0?(\d+):0?(\d+)(?:\.(\d+))[\+\-]\d{2}:\d{2}$/;break;default:s=/^(\d{4})-0?(\d+)-0?(\d+)[T ]0?(\d+):0?(\d+):0?(\d+)$/}return s.test(e)}function h(){return scorm.debug(_.prefix+": You didn't call 'start()' yet, or you already terminated, ignoring.",2),"false"}function p(){return(new Date).getTime()}function g(e,s){e=parseFloat(e);return parseFloat(e.toPrecision(s))}function b(e,s){var t=0;switch(e){case"order_matters":t=/^\{order_matters=.*?\}/;break;case"case_matters":t=/^\{case_matters=.*?\}/;break;case"lang":t=/^\{lang=.*?\}/;break;default:scorm.debug(_.prefix+": Sorry, this is not a valid Response type.",1)}return t.exec(s)}function y(){scorm.debug("Times Up!");var e=scorm.getvalue("cmi.time_limit_action").split(",");"message"===e[1]&&f.triggerEvent(d,"message",{text:"Time Limit Exceeded"}),scorm.set("exit_type","timeout"),"exit"===e[0]?i():f.triggerEvent(d,"continue")}function x(e,s){var t,r,o,a="",c=0,i=[];switch(e){case"true-false":return"true"===(s=s.toString().toLowerCase())||"false"===s?"1.2"===scorm.getAPIVersion()?s.substring(0,1):s:(scorm.debug(_.prefix+": Developer, you're not passing true or false for true-false.  I got "+s+" instead",1),"");case"choice":if("1.2"===scorm.getAPIVersion()){if(f.isArray(s))return 26<s.length&&_.scorm_strict&&scorm.debug(_.prefix+": Developer, you're passing a sum of values that exceeds SCORMs limit of 26 for this pattern.  Consider using 'performance' instead.",2),s.join(",");scorm.debug(_.prefix+": Developer, you're not passing a array type for sequencing/choice.  I got "+typeof s+" instead\n"+JSON.stringify(s),1),s=""}case"sequencing":if(f.isArray(s)){for(o in o=0,36<s.length&&_.scorm_strict&&(scorm.debug(_.prefix+": Developer, you're passing a sum of values that exceeds SCORMs limit of 36 for this pattern.",2),s=s.slice(0,36)),s)s.hasOwnProperty(o)&&10<s[o].length&&_.scorm_strict&&(scorm.debug(_.prefix+": Developer, you're passing values that exceed SCORMs limit of 10 characters.  Yours have "+s[o].length+". I will truncate this as not to lose data.",2),s[o]=s[o].substring(0,10));s=a="1.2"===scorm.getAPIVersion()?s.join(","):s.join("[,]")}else scorm.debug(_.prefix+": Developer, you're not passing a array type for sequencing/choice.  I got "+typeof s+" instead\n"+JSON.stringify(s),1),s="";return s;case"fill-in":return s=f.isPlainObject(s)?(void 0!==s.case_matters&&(a+="{case_matters="+s.case_matters+"}"),void 0!==s.order_matters&&(a+="{order_matters="+s.order_matters+"}"),void 0!==s.lang&&(a+="{lang="+s.lang+"}"),f.isArray(s.words)?a+=s.words.join("[,]"):scorm.debug(_.prefix+": Developer, expected an array of word(s) for fill-in.  I got "+typeof s.words+" instead",1),a):(scorm.debug(_.prefix+": Developer, you're not passing a object type for fill in.  I got "+typeof s+" instead",1),"");case"long-fill-in":return s=f.isPlainObject(s)?(void 0!==s.case_matters&&(a+="{case_matters="+s.case_matters+"}"),void 0!==s.lang&&(a+="{lang="+s.lang+"}"),a+=s.text):(scorm.debug(_.prefix+": Developer, you're not passing a object type for long fill in.  I got "+typeof s+" instead",1),"");case"matching":if(f.isArray(s)){for(r=s.length,c=0;c<r;){if(!f.isArray(s[c]))return scorm.debug(_.prefix+": Developer, you're not passing a array type for matching/performance.  I got "+typeof s+" instead",1),"";i.push("1.2"===scorm.getAPIVersion()?s[c].join("."):s[c].join("[.]")),c+=1}s=a="1.2"===scorm.getAPIVersion()?i.join(","):i.join("[,]")}else scorm.debug(_.prefix+": Developer, you're not passing a array type for matching/performance.  I got "+typeof s+" instead",1),s="";return s;case"performance":if(f.isArray(s))if(f.isArray(s)){for(r=s.length,c=0;c<r;){if(!f.isArray(s[c]))return scorm.debug(_.prefix+": Developer, you're not passing a array type for performance learner response.  I got "+typeof s[c]+" instead on "+c,1),scorm.debug(s,1),"";i.push(s[c].join("[.]")),c+=1}a=i.join("[,]")}else scorm.debug(_.prefix+": Developer, you're not passing a array type for performance learner response.  I got "+typeof s+" instead",1),s="";else if(void 0!==s.order_matters&&(a+="{order_matters="+s.order_matters+"}"),f.isArray(s.answers)){for(r=s.answers.length,c=0;c<r;){if(!f.isArray(s.answers[c]))return scorm.debug(_.prefix+": Developer, you're not passing a array type for performance correct response.  I got "+typeof s.answers[c]+" instead on "+c,1),scorm.debug(s,1),"";f.isPlainObject(s.answers[c][1])&&(t=[g(s.answers[c][1].min,7),g(s.answers[c][1].max,7)].join("[:]"),s.answers[c][1]=t),i.push(s.answers[c].join("[.]")),c+=1}a+=i.join("[,]")}else scorm.debug(_.prefix+": Developer, you're not passing a array type for performance correct response.  I got "+typeof s.answers+" instead",1),scorm.debug(s,1);return s=a;case"numeric":return"number"==typeof s?a=s.toString():f.isPlainObject(s)?a=(i=[g(s.min,7),g(s.max,7)]).join("[:]"):("NaN"===(a=parseFloat(s))&&scorm.debug(_.prefix+": Developer, your not passing a number for a numeric interaction.  I got "+s+" instead",1),a+=""),a;case"likert":case"other":return s.toString();default:return scorm.debug(_.prefix+": Sorry, invalid interaction type detected for "+e+" on "+s,1),!1}}function w(e,s){var t,r=0,o=[],a={},c=!1;switch(e){case"true-false":return"1.2"===scorm.getAPIVersion()?"t"===s?"true":"false":s;case"choice":case"sequencing":return s=o=s.split("[,]");case"fill-in":return null!==(o=b("case_matters",s))&&-1!==o[0].search(/^\{case_matters=(true|false)\}$/)&&(a.case_matters=o[0].substring("{case_matters=".length,o[0].length-1),s=s.substring(o[0].length,s.length),scorm.debug("=== case matters"+s,4)),null!==(o=b("order_matters",s))&&-1!==o[0].search(/^\{order_matters=(true|false)\}$/)&&(a.order_matters=o[0].substring("{order_matters=".length,o[0].length-1),s=s.substring(o[0].length,s.length),scorm.debug("=== order matters"+s,4)),null!==(o=b("lang",s))&&-1!==o[0].search(/^\{lang=.*?\}$/)&&(a.lang=o[0].substring("{lang=".length,o[0].length-1),s=s.substring(o[0].length,s.length)),a.words=s.split("[,]"),a;case"long-fill-in":return null!==(o=b("case_matters",s))&&-1!==o[0].search(/^\{case_matters=(true|false)\}$/)&&(a.case_matters=o[0].substring("{case_matters=".length,o[0].length-1),s=s.substring(o[0].length,s.length),scorm.debug("=== case matters"+s,4)),null!==(o=b("lang",s))&&-1!==o[0].search(/^\{lang=.*?\}$/)&&(a.lang=o[0].substring("{lang=".length,o[0].length-1),s=s.substring(o[0].length,s.length)),a.text=s,a;case"matching":for(t=(o=s.split("[,]")).length,r=0;r<t;)o[r]=o[r].split("[.]"),r+=1;return o;case"performance":for(null!==(o=b("order_matters",s))&&-1!==o[0].search(/^\{order_matters=(true|false)\}$/)&&(c=!0,a.order_matters=o[0].substring("{order_matters=".length,o[0].length-1),s=s.substring(o[0].length,s.length),scorm.debug("=== order matters"+s,4)),t=(o=s.split("[,]")).length,r=0;r<t;)o[r]=o[r].split("[.]"),r+=1;return c?(a.answers=o,a):o;case"numeric":case"likert":case"other":return s;default:return scorm.debug(_.prefix+": Sorry, invalid interaction type detected for "+e+" on "+s,1),!1}}function S(){var e=JSON.stringify(_.suspend_data).replace(/[^\f\r\n\t\v\0\s\S\w\W\d\D\b\\B\\cX\\xhh\\uhhh]/gi,""),e=_.base64?window.btoa(encodeURIComponent(e)):encodeURIComponent(e);return"true"===scorm.setvalue("cmi.suspend_data",e)?(scorm.debug(_.prefix+": Suspend Data saved",4),scorm.debug(_.suspend_data,4),"true"):"false"}function I(){if(scorm.isConnectionActive()){var e,s,t=0,r=0;if(m.completion_status=scorm.getvalue("cmi.completion_status"),m.success_status=scorm.getvalue("cmi.success_status"),(m.score.raw=0)===_.totalInteractions||0===_.totalObjectives)return scorm.debug(_.prefix+": Sorry, I cannot calculate Progress as the totalInteractions and or Objectives are zero",2),"false";if(s=parseInt(scorm.getvalue("cmi.objectives._count"),10),scorm.debug(_.prefix+": Objectives Count is "+s),0<s)for(r=s-=1;0<=r;)e=parseFloat(scorm.getvalue("cmi.objectives."+r+".score.raw")),scorm.debug(_.prefix+": Score Raw: "+e),isNaN(e)?scorm.debug(_.prefix+": We got a NaN converting objectives."+r+".score.raw.  This may be a global/local objective via the imsmanifest.xml.",2):m.score.raw+=parseFloat(e),"completed"===scorm.getvalue("cmi.objectives."+r+".completion_status")&&(t+=1),--r;return m.score.raw=""+m.score.raw,parseFloat(m.score.max)-parseFloat(m.score.min)==0?(scorm.debug(_.prefix+": Division by Zero for scoreMax - scoreMin "+m.score.max,2),m.score.scaled="1"):(m.score.scaled=""+g((m.score.raw-m.score.min)/(m.score.max-m.score.min),7),scorm.debug(_.prefix+": Score Scaled = "+m.score.scaled,3)),m.progress_measure=""+g(t/_.totalObjectives,7),m.completion_status=parseFloat(m.progress_measure)>=parseFloat(m.completion_threshold)?"completed":"incomplete",scorm.debug(_.prefix+": Pass/Fail check - Calculated scaled score:"+parseFloat(m.score.scaled)+" vs. "+parseFloat(m.scaled_passing_score),3),m.success_status=parseFloat(m.score.scaled)>=parseFloat(m.scaled_passing_score)?"passed":"failed",_.doNotStatusUntilFinish||(scorm.debug(_.prefix+" Setting score immediately...",4),scorm.setvalue("cmi.score.raw",m.score.raw),scorm.setvalue("cmi.score.scaled",m.score.scaled),scorm.setvalue("cmi.progress_measure",m.progress_measure),scorm.setvalue("cmi.completion_status",m.completion_status),scorm.setvalue("cmi.success_status",m.success_status)),{score_scaled:m.score.scaled,success_status:m.success_status,progress_measure:m.progress_measure,completion_status:m.completion_status}}return h()}function j(e){if(e&&l&&(scorm.debug(_.prefix+": I am finishing... storing score on finish? "+_.doNotStatusUntilFinish,3),_.doNotStatusUntilFinish))return scorm.setvalue("cmi.score.raw",m.score.raw),scorm.setvalue("cmi.score.scaled",m.score.scaled),scorm.setvalue("cmi.progress_measure",m.progress_measure),scorm.setvalue("cmi.completion_status",m.completion_status),scorm.setvalue("cmi.success_status",m.success_status);var s,t,r,o,a,c,i,n;!u&&(s="cmi.success_status",t="cmi.completion_status",r=scorm.get("success_status"),o=scorm.get("completion_status"),n=i=!1,"passed"!==(a=d.getvalue(s))&&"failed"!==a||(i=!0),"completed"!==(c=d.getvalue(t))&&"incomplete"!==c||(n=!0),"finish"===scorm.get("exit_type")||e)&&(a===r||i||(scorm.debug(_.prefix+": Overriding default success status to "+r,3),d.setvalue(s,r)),"1.2"!==scorm.getAPIVersion()||"completion_status"!==_.scorm_status_persist||n?c===o||n||(scorm.debug(_.prefix+": Overriding default completion status to "+o,3),d.setvalue(t,o)):d.setvalue(t,o))}this.start=function(){var e="";return scorm.debug(_.prefix+": I am starting...",3),t?(scorm.debug(_.prefix+": You already called start!  I don't see much point in doing this more than once.",2),!1):(t=!0,_.startTime=p(),e=scorm.getvalue("cmi.launch_data"),"json"===_.launch_data_type?_.launch_data=JSON.parse(e):e.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function(e,s,t,r){_.launch_data[s]=r}),scorm.debug(_.prefix+": Launch Data:",4),scorm.debug(_.launch_data,4),_.mode=scorm.getvalue("cmi.mode"),_.entry=scorm.getvalue("cmi.entry"),"review"===_.mode||""===_.entry||"resume"===_.entry?(scorm.debug(_.prefix+": Resuming...",4),_.location=scorm.getvalue("cmi.location"),_.suspend_data=_.base64?decodeURIComponent(window.atob(scorm.getvalue("cmi.suspend_data"))):decodeURIComponent(scorm.getvalue("cmi.suspend_data")),0<_.suspend_data.length&&!v(_.suspend_data)?(scorm.debug(_.prefix+": Returning suspend data object from a prior session",4),_.suspend_data=_.useJSONSuspendData?JSON.parse(_.suspend_data):_.suspend_data,scorm.debug(_.suspend_data,4),""===_.entry&&(_.entry="resume")):scorm.debug(_.prefix+": Creating new suspend data object",4)):(scorm.debug(_.prefix+": First time running this SCO based on LMS entry value.",4),scorm.debug(_.prefix+": Creating new suspend data object",4)),v(e=scorm.getvalue("cmi.completion_threshold"))||"-1"===e||(m.completion_threshold=e),v(e=scorm.getvalue("cmi.scaled_passing_score"))||"-1"===e||(parseFloat(1<e)&&(m.scaled_passing_score=(10*parseFloat(e)/1e3).toString()),_.scaled_passing_score=m.scaled_passing_score),m.completion_status=scorm.getvalue("cmi.completion_status"),m.success_status=scorm.getvalue("cmi.success_status"),_.comments_from_lms=(()=>{if(scorm.isConnectionActive()){var e,s="cmi.comments_from_lms.",t=scorm.getvalue(s+"_count"),r=[],o={};if(!v(t))return"false";for(--t,e=0;e<=t;)s+=e+".",o.comment=scorm.getvalue(s+"comment"),o.location=scorm.getvalue(s+"location"),o.timestamp=scorm.getvalue(s+"timestamp"),r.push(o),o={},e+=1;return r}return h()})(),"false"!==_.comments_from_lms&&f.triggerEvent(d,"comments_lms",{data:_.comments_from_lms}),_.max_time_allowed=scorm.getvalue("cmi.max_time_allowed"),e=_.max_time_allowed,/^(?:P)([^T]*)(?:T)?(.*)?$/.test(e)?_.initiate_timer&&(scorm.debug(_.prefix+": This SCO has a set time, I am starting the timer for "+_.max_time_allowed+"..."),d.startTimer()):scorm.debug(_.prefix+": This is not ISO8601 time duration. "+_.max_time_allowed),!0)},this.setTotals=function(e){return l=!0,scorm.isConnectionActive()?(v(e.totalInteractions)||(_.totalInteractions=e.totalInteractions),v(e.totalObjectives)||(_.totalObjectives=e.totalObjectives),v(e.scoreMin)||(m.score.min=g(e.scoreMin,7),scorm.setvalue("cmi.score.min",m.score.min.toString())),v(e.scoreMax)||(m.score.max=g(e.scoreMax,7),scorm.setvalue("cmi.score.max",m.score.max.toString())),"true"):h()},this.startTimer=function(){var e=10*scorm.ISODurationToCentisec(_.max_time_allowed);setTimeout(y,e)},this.debug=scorm.debug,this.getvalue=scorm.getvalue,this.setvalue=scorm.setvalue,this.getMode=function(){return scorm.isConnectionActive()?_.mode:h()},this.getEntry=function(){return scorm.isConnectionActive()?_.entry:h()},this.setBookmark=function(e){return scorm.isConnectionActive()?(_.location=e.toString(),scorm.setvalue("cmi.location",_.location)):h()},this.getBookmark=function(){return scorm.isConnectionActive()?_.location:h()},this.progress=I,this.setSuspendDataByPageID=function(e,s,t){if(scorm.isConnectionActive()){for(var r=0,o=_.suspend_data.pages.length;r<o;){if(_.suspend_data.pages[r].id===e)return _.suspend_data.pages[r].data=t,scorm.debug(_.prefix+": Suspend Data Set",4),scorm.debug(_.suspend_data,4),S();r+=1}return _.suspend_data.pages.push({id:e,title:s,data:t}),scorm.debug(_.prefix+": Suspend Data set:",4),scorm.debug(_.suspend_data,4),S()}return h()},this.getSuspendDataByPageID=function(e){if(scorm.isConnectionActive()){for(var s=0,t=_.suspend_data.pages.length;s<t;){if(_.suspend_data.pages[s].id===e)return _.suspend_data.pages[s].data;s+=1}return"false"}return h()},this.getSecondsFromStart=function(){return _.startTime-p()},this.setInteraction=function(e){if(scorm.isConnectionActive()){var s,t,r,o,a,c,i,n,m,u,l,d=scorm.getAPIVersion(),p="cmi.interactions.",g=e.timestamp||scorm.isoStringToDate(scorm.getvalue(p+scorm.getInteractionByID(e.id)+".timestamp"));if(!f.isPlainObject(e))return scorm.debug(_.prefix+": Developer, your not passing a {object} argument!!  Got "+typeof e+" instead.",1),"false";if(v(e.id)){for(l in scorm.debug(_.prefix+": Developer, your passing a interaction without a ID\nSee question:\n"+e.description,1),e)e.hasOwnProperty(l)&&scorm.debug("key: "+l+"\n value: "+e[l]);return"false"}if("date"===f.type(e.timestamp)&&(i="1.2"===scorm.getAPIVersion()?scorm.dateToscorm12Time(e.timestamp):scorm.isoDateToString(e.timestamp)),e.timestamp=i,"date"===f.type(e.latency)?(n=.001*(e.latency.getTime()-g.getTime()),e.latency="1.2"===scorm.getAPIVersion()?scorm.centisecsToSCORM12Duration(100*n):scorm.centisecsToISODuration(100*n,!0)):0<e.learner_response.length&&!v(e.learner_response)&&(e.latency=new Date,n=.001*(e.latency.getTime()-g.getTime()),e.latency="1.2"===scorm.getAPIVersion()?scorm.centisecsToSCORM12Duration(100*n):scorm.centisecsToISODuration(100*n,!0)),c="_count",p+=(s="journaled"===_.interaction_mode||"1.2"===d||v(s=scorm.getInteractionByID(e.id))?"-1"===scorm.getvalue(p+c)?"0":scorm.getvalue(p+c):s)+".",v(e.id)||(m=scorm.setvalue(p+"id",e.id)),!v(e.type)){if("1.2"===scorm.getAPIVersion())switch(e.type){case"other":case"long-fill-in":e.type="fill-in"}m=scorm.setvalue(p+"type",e.type)}if(c="objectives._count",void 0!==e.objectives)for(r=0,u=e.objectives.length;r<u;)"false"===(t=scorm.getInteractionObjectiveByID(s,e.objectives[r].id))&&(t="-1"===scorm.getvalue(p+c)?"0":scorm.getvalue(p+c)),m=scorm.setvalue(p+"objectives."+t+".id",e.objectives[r].id),r+=1;if(void 0!==e.timestamp&&(m="1.2"!==d?scorm.setvalue(p+"timestamp",e.timestamp):scorm.setvalue(p+"time",e.timestamp)),c="correct_responses._count",f.isArray(e.correct_responses))for(o=0,u=e.correct_responses.length;o<u;)a=scorm.getInteractionCorrectResponsesByPattern(s,e.correct_responses[o].pattern),scorm.debug(_.prefix+": Trying to locate pattern "+e.correct_responses[o].pattern+" resulted in "+a,4),"false"===a&&(a="-1"===scorm.getvalue(p+c)?0:scorm.getvalue(p+c),scorm.debug(_.prefix+": p is now "+a,4)),"match"===a?scorm.debug(_.prefix+": Developer, I've already added this correct response type '"+e.correct_responses[o].pattern+"'",2):m=scorm.setvalue(p+"correct_responses."+a+".pattern",x(e.type,e.correct_responses[o].pattern)),o+=1;else scorm.debug(_.prefix+": Something went wrong with Correct Responses, it wasn't an Array.",1);return v(e.weighting)||(m=scorm.setvalue(p+"weighting",e.weighting)),v(e.learner_response)||(m="1.2"!==d?scorm.setvalue(p+"learner_response",x(e.type,e.learner_response)):scorm.setvalue(p+"student_response",x(e.type,e.learner_response))),v(e.result)||(m=scorm.setvalue(p+"result",e.result)),v(e.latency)||(m=scorm.setvalue(p+"latency",e.latency)),m="1.2"===d||v(e.description)?m:scorm.setvalue(p+"description",e.description)}return h()},this.getInteraction=function(e){if(scorm.isConnectionActive()){var s,t,r="cmi.interactions.",o=0,a={},c=scorm.getInteractionByID(e);if("false"===c)return c;if(r+=c+".",a.id=e,a.type=scorm.getvalue(r+"type"),s=scorm.getvalue(r+"objectives._count"),c=scorm.getvalue(r+"timestamp"),e=scorm.getvalue(r+"latency"),c=n(c)?scorm.isoStringToDate(c):c,e=n(e)?scorm.isoStringToDate(e):e,a.objectives=[],"false"!==s)for(;o<s;)a.objectives.push({id:scorm.getvalue(r+"objectives."+o+".id")}),o+=1;if(a.timestamp=c,t=scorm.getvalue(r+"correct_responses._count"),a.correct_responses=[],"false"!==t)for(o=0;o<t;)a.correct_responses.push({pattern:w(a.type,scorm.getvalue(r+"correct_responses."+o+".pattern"))}),o+=1;return a.weighting=scorm.getvalue(r+"weighting"),a.learner_response=w(a.type,scorm.getvalue(r+"learner_response")),a.result=scorm.getvalue(r+"result"),a.latency=e,a.description=scorm.getvalue(r+"description"),a}return h()},this.setObjective=function(e){if(scorm.isConnectionActive()){var s,t="cmi.objectives.",r=scorm.getObjectiveByID(e.id),o="false",a=!1,c=": Passed no or bad ",i=" ignored.",n=scorm.setvalue,m=scorm.getAPIVersion();if(scorm.debug(_.prefix+": Setting Objective at "+r+" (This may be false)"),v(r)){if("false"===(r=scorm.getvalue("cmi.objectives._count")))return scorm.debug(_.prefix+": LMS is return false, can not proceed, check error codes"),r;scorm.debug(_.prefix+": Objective "+e.id+" was not found.  Adding new at "+r+" "+e.description),a=!0}if(t+=r+".",a){if(v(e.id)){for(s in scorm.debug(_.prefix+": You did not pass an objective ID!!  What I did get below:",1),e)e.hasOwnProperty(s)&&scorm.debug("key: "+s+"\n value: "+e[s]);return"false"}n(t+"id",e.id.toString())}return f.isPlainObject(e.score)?("2004"===m&&(o=v(e.score.scaled)?scorm.debug(_.prefix+c+t+"score.scaled: "+e.score.scaled+i,3):n(t+"score.scaled",g(e.score.scaled,7).toString())),o=v(e.score.raw)?scorm.debug(_.prefix+c+t+"score.raw: "+e.score.raw+i,3):n(t+"score.raw",g(e.score.raw,7).toString()),o=v(e.score.min)?scorm.debug(_.prefix+c+t+"score.min: "+e.score.min+i,3):n(t+"score.min",g(e.score.min,7).toString()),o=v(e.score.max)?scorm.debug(_.prefix+c+t+"score.max: "+e.score.max+i,3):n(t+"score.max",g(e.score.max,7).toString())):scorm.debug(_.prefix+": Did not receive a score object.  May or may not be an issue.",4),o="2004"===m?(o=v(e.success_status)?scorm.debug(_.prefix+c+t+"success_status: "+e.success_status+i,3):n(t+"success_status",e.success_status),o=v(e.completion_status)?scorm.debug(_.prefix+c+t+"completion_status: "+e.completion_status+i,3):n(t+"completion_status",e.completion_status),o=v(e.progress_measure)?scorm.debug(_.prefix+c+t+"progress_measure: "+e.progress_measure+i,3):n(t+"progress_measure",e.progress_measure),v(e.description)?scorm.debug(_.prefix+c+t+"description: "+e.description+i,3):n(t+"description",e.description)):v(e[_.scorm_status_persist])?scorm.debug(_.prefix+c+t+"status: "+e[_.scorm_status_persist]+i,3):n(t+"status",e[_.scorm_status_persist]),scorm.debug(_.prefix+": Progress\n"+JSON.stringify(I(),null," "),4),o.toString()}return h()},this.getObjective=function(e){var s;return scorm.isConnectionActive()?(s="cmi.objectives.","false"===(e=scorm.getObjectiveByID(e))?e:(s+=e+".",{id:scorm.getvalue(s+"id"),score:{scaled:scorm.getvalue(s+"score.scaled"),raw:scorm.getvalue(s+"score.raw"),min:scorm.getvalue(s+"score.min"),max:scorm.getvalue(s+"score.max")},success_status:scorm.getvalue(s+"success_status"),completion_status:scorm.getvalue(s+"completion_status"),progress_measure:scorm.getvalue(s+"progress_measure"),description:scorm.getvalue(s+"description")})):h()},this.setCommentFromLearner=function(e,s,t){var r,o;return scorm.isConnectionActive()?(r="cmi.comments_from_learner.","false"===(o=scorm.getvalue("cmi.comments_from_learner._count"))?(scorm.debug(_.prefix+": Sorry, LMS returned a comments count of 'false'.  Review error logs."),o):((0===e.length||4e3<e.length)&&scorm.debug(_.prefix+": Sorry, message from learner was empty or exceeded the limit. Length:"+e.length,2),r+=o+".",scorm.setvalue(r+"comment",e),scorm.setvalue(r+"location",s),scorm.setvalue(r+"timestamp",scorm.isoDateToString(t)))):h()},this.gradeIt=function(){var e=1,s=scorm.getvalue("cmi.score.raw"),t=scorm.getvalue("cmi.score.min"),r=scorm.getvalue("cmi.score.max");return r-t==0?(scorm.debug(_.prefix+": Division by Zero for scoreMax - scoreMin "+r,2),scorm.setvalue("cmi.score.scaled",e)):(e=""+(s-t)/(r-t),scorm.debug(_.prefix+": Score Scaled = "+e,3),scorm.setvalue("cmi.score.scaled",g(e,7))),"completed"!==m.completion_status&&(m.completion_status=parseFloat(m.progress_measure)>=parseFloat(m.completion_threshold)?"completed":"incomplete",scorm.setvalue("cmi.completion_status",m.completion_status)),"passed"!==m.success_status&&(m.success_status=parseFloat(e)>=parseFloat(m.scaled_passing_score)?"passed":"failed"),scorm.setvalue("cmi.success_status",m.success_status),"true"},this.happyEnding=function(){var e=scorm.isConnectionActive();return l=!1,e&&_.happyEnding&&!_.doNotStatusUntilFinish?(u=!0,scorm.setvalue("cmi.score.scaled","1"),scorm.setvalue("cmi.score.min","0"),scorm.setvalue("cmi.score.max","100"),scorm.setvalue("cmi.score.raw","100"),scorm.setvalue("cmi.success_status","passed"),scorm.setvalue("cmi.progress_measure","1"),scorm.setvalue("cmi.completion_status","completed")):e&&_.happyEnding&&_.doNotStatusUntilFinish?(u=!0,m.score.scaled="1",m.score.raw="100",m.success_status="passed",m.completion_status="completed",m.progress_measure="1",scorm.setvalue("cmi.score.min","0"),scorm.setvalue("cmi.score.max","100")):h()},this.commit=function(){return scorm.isConnectionActive()?scorm.commit(""):h()},this.suspend=function(){return scorm.isConnectionActive()?(scorm.debug(_.prefix+": I am suspending...",3),scorm.setvalue("cmi.exit","suspend"),t=!1,scorm.terminate()):h()},this.finish=function(){return scorm.isConnectionActive()?(scorm.setvalue("cmi.exit","normal"),j(!0),t=!1,scorm.terminate()):h()},this.timeout=function(){return scorm.isConnectionActive()?(scorm.debug(_.prefix+": I am timing out...",3),scorm.setvalue("cmi.exit","time-out"),j(!0),t=!1,scorm.terminate()):h()},this.isISO8601=n,this.getAPIVersion=scorm.getAPIVersion,this.set=function(e,s){switch(e){case"version":case"createDate":case"modifiedDate":case"prefix":case"scaled_passing_score":case"completion_threshold":a(405);break;default:_[e]=s}return!0},this.get=function(e){return void 0===_[e]?(a(404),!1):_[e]},f.addEvent(window,"loaded",function(){var e;return s=scorm.initialize(),scorm.debug(_.prefix+": SCO Loaded from window.onload "+s,4),"true"===s?(d.start(),f.triggerEvent(d,"load")):(e="Sorry, unable to initialize the SCORM Runtime API. Returned: "+s,scorm.debug(_.prefix+e),c(e)),s}),f.addEvent(window,"onbeforeunload",i),f.addEvent(window,"unload",i),f.addEvent(scorm,"exception",function(e){c(e.error)})}